<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BGA-Trainer Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f4f6;
    }
    
    .card {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      padding: 24px;
      margin-bottom: 20px;
    }
    
    .header {
      background: linear-gradient(90deg, #1e3a8a, #2563eb);
      color: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    
    .bga-table {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: 16px;
    }
    
    .bga-item {
      position: relative;
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      padding: 12px;
      text-align: center;
    }
    .bga-item label {
      display: block;
      font-size: 0.875rem;
      color: #4b5563;
      font-weight: 500;
    }
    .bga-item input {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      width: 100%;
      border: none;
      background: transparent;
      text-align: center;
      padding: 4px 0 0;
      outline: none;
    }
    
    .bga-item.norm-green { border-color: #10b981; background-color: #f0fdf4; }
    .bga-item.norm-red { border-color: #ef4444; background-color: #fef2f2; }
    .bga-item.norm-blue { border-color: #3b82f6; background-color: #eff6ff; }

    .tooltip {
      position: absolute;
      top: 2px;
      right: 5px;
      cursor: help;
      color: #9ca3af;
    }
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 220px;
      background-color: #111827;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 0.75rem;
    }
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    
    .response-list {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    @media (min-width: 640px) {
      .response-list.two-col {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .response-list li {
      margin: 0;
    }
    .response-list input[type="radio"] {
      display: none;
    }
    .response-list label {
      display: block;
      padding: 16px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      background-color: #f3f4f6;
      color: #374151;
      cursor: pointer;
      transition: all 0.2s ease;
      font-weight: 500;
    }
    
    .response-list input[type="radio"]:checked + label {
      background-color: #3b82f6;
      color: white;
      border-color: #2563eb;
    }
    
    .response-list input[type="radio"]:disabled + label,
    fieldset:disabled .response-list label {
        background-color: #f3f4f6;
        color: #9ca3af;
        cursor: not-allowed;
        border-color: #e5e7eb;
    }

    .btn {
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }
    .btn-primary {
      background-color: #2563eb;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1d4ed8;
    }
    .btn-secondary {
      background-color: #e5e7eb;
      color: #374151;
    }
    .btn-secondary:hover {
      background-color: #d1d5db;
    }

    .mode-switch {
      display: flex;
      border-radius: 8px;
      background-color: #e5e7eb;
      padding: 4px;
      width: fit-content;
    }
    .mode-switch input[type="radio"] {
      display: none;
    }
    .mode-switch label {
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      color: #4b5563;
      transition: all 0.2s ease;
    }
    .mode-switch input[type="radio"]:checked + label {
      background-color: #ffffff;
      color: #111827;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    details {
      background-color: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      margin-bottom: 16px;
    }
    details summary {
      padding: 16px;
      cursor: pointer;
      font-weight: 600;
      color: #1f2937;
      list-style: none;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    details summary::-webkit-details-marker {
      display: none;
    }
    details .content {
      padding: 0 16px 16px;
      border-top: 1px solid #e5e7eb;
    }
    
    .clinical-explanation {
      background-color: #eff6ff;
      border: 1px solid #3b82f6;
      border-radius: 8px;
      padding: 16px;
      margin-top: 16px;
    }
    .clinical-explanation h4 {
      margin: 0 0 8px;
      color: #1e40af;
      font-size: 0.95rem;
    }
    .clinical-explanation p {
      margin: 0 0 8px;
      font-size: 0.875rem;
      line-height: 1.5;
    }
    
    .hidden {
      display: none;
    }

  </style>
</head>
<body class="p-4 md:p-8">

  <div class="max-w-3xl mx-auto">
    
    <header class="header">
      <div class="flex justify-between items-center">
        <h1 class="text-xl md:text-2xl font-bold">BGA-Trainer Pro</h1>
        <div id="mode-chip" class="bg-white/20 text-white text-xs font-semibold px-3 py-1 rounded-full">
          BASIS MODUS
        </div>
      </div>
      <p class="text-sm text-white/80 mt-2">Systematisches BGA-Training f√ºr die Intensivpflege</p>
    </header>

    <div class="card flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
      <div>
        <h2 class="text-lg font-semibold text-gray-800 m-0">Lern-Modus</h2>
        <p class="text-gray-600 m-0 text-sm">W√§hle deinen Erfahrungsgrad.</p>
      </div>
      <div class="mode-switch">
        <input type="radio" id="mode-basic" name="mode" value="basic" checked>
        <label for="mode-basic">Basis</label>
        <input type="radio" id="mode-advanced" name="mode" value="advanced">
        <label for="mode-advanced">Advanced</label>
        <input type="radio" id="mode-mixed" name="mode" value="mixed">
        <label for="mode-mixed">Mixed</label>
      </div>
    </div>

    <div class="card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-semibold text-gray-800 m-0">
          Fall #<span id="case-id">1</span>
        </h2>
        <span id="case-complexity" class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-800"></span>
      </div>

      <div id="clinical-context" class="mb-4 p-3 bg-blue-50 border-l-4 border-blue-500 text-sm text-gray-700 rounded">
        Klinischer Kontext wird hier angezeigt...
      </div>

      <h3 class="text-base font-semibold text-gray-700 mb-3">Grundwerte</h3>
      <div class="bga-table mb-4">
        <div class="bga-item" id="item-ph">
          <label for="ph">pH</label>
          <input type="number" id="ph" step="0.01" value="7.40" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">S√§ure-Basen-Status. Niedrig = Azidose, Hoch = Alkalose.</span>
          </div>
        </div>
        <div class="bga-item" id="item-pco2">
          <label for="pco2">pCO‚ÇÇ (mmHg)</label>
          <input type="number" id="pco2" step="0.1" value="40.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Respiratorischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-hco3">
          <label for="hco3">HCO‚ÇÉ‚Åª (mmol/L)</label>
          <input type="number" id="hco3" step="0.1" value="24.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Metabolischer Parameter.</span>
          </div>
        </div>
        <div class="bga-item" id="item-be">
          <label for="be">BE (mmol/L)</label>
          <input type="number" id="be" step="0.1" value="0.0" readonly>
          <div class="tooltip">?
            <span class="tooltip-text">Base Excess.</span>
          </div>
        </div>
      </div>

      <div id="advanced-values-container" class="hidden">
        <h3 class="text-base font-semibold text-gray-700 mb-3">Erweiterte Werte</h3>
        <div class="bga-table">
          <div class="bga-item" id="item-laktat">
            <label for="laktat">Laktat (mmol/L)</label>
            <input type="number" id="laktat" step="0.1" value="1.0" readonly>
          </div>
          <div class="bga-item" id="item-na">
            <label for="na">Na‚Å∫ (mmol/L)</label>
            <input type="number" id="na" step="1" value="140" readonly>
          </div>
          <div class="bga-item" id="item-cl">
            <label for="cl">Cl‚Åª (mmol/L)</label>
            <input type="number" id="cl" step="1" value="105" readonly>
          </div>
          <div class="bga-item" id="item-k">
            <label for="k">K‚Å∫ (mmol/L)</label>
            <input type="number" id="k" step="0.1" value="4.0" readonly>
          </div>
          <div class="bga-item" id="item-glukose">
            <label for="glukose">Glukose (mg/dL)</label>
            <input type="number" id="glukose" step="1" value="100" readonly>
          </div>
        </div>
      </div>
      
    </div>
    
    <details>
      <summary>Normwerte (Spickzettel)</summary>
      <div class="content text-sm text-gray-700">
        <ul class="list-disc pl-5 space-y-1">
          <li><strong>pH:</strong> 7.35 ‚Äì 7.45</li>
          <li><strong>pCO‚ÇÇ:</strong> 35 ‚Äì 45 mmHg</li>
          <li><strong>HCO‚ÇÉ‚Åª:</strong> 22 ‚Äì 26 mmol/L</li>
          <li><strong>BE:</strong> -2 ‚Äì +2 mmol/L</li>
          <li><strong>Laktat:</strong> 0.5 ‚Äì 2.0 mmol/L</li>
          <li><strong>Na‚Å∫:</strong> 135 ‚Äì 145 mmol/L</li>
          <li><strong>Cl‚Åª:</strong> 98 ‚Äì 108 mmol/L</li>
          <li><strong>K‚Å∫:</strong> 3.5 ‚Äì 5.0 mmol/L</li>
          <li><strong>Glukose:</strong> 70 ‚Äì 110 mg/dL</li>
        </ul>
        <p class="mt-2 text-xs text-gray-500">Beachte: Normwerte k√∂nnen je nach Labor leicht abweichen.</p>
      </div>
    </details>

    <div class="card">
      <h2 class="text-lg font-semibold text-gray-800 m-0 mb-4">1. Prim√§re St√∂rung</h2>
      <fieldset id="primary-fieldset">
        <ul class="response-list two-col">
          <li><input type="radio" id="p-normal" name="primary" value="NORMAL"><label for="p-normal">Normal</label></li>
          <li><input type="radio" id="p-resp-aci" name="primary" value="RESP_ACI"><label for="p-resp-aci">Respiratorische Azidose</label></li>
          <li><input type="radio" id="p-resp-alk" name="primary" value="RESP_ALK"><label for="p-resp-alk">Respiratorische Alkalose</label></li>
          <li><input type="radio" id="p-met-aci" name="primary" value="MET_ACI"><label for="p-met-aci">Metabolische Azidose</label></li>
          <li><input type="radio" id="p-met-alk" name="primary" value="MET_ALK"><label for="p-met-alk">Metabolische Alkalose</label></li>
          <li id="p-mixed-li" class="hidden"><input type="radio" id="p-mixed" name="primary" value="P_MIXED"><label for="p-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <fieldset id="comp-basic-fieldset" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensation (Basis)</legend>
        <ul class="response-list">
          <li><input type="radio" id="c-none" name="comp_basic" value="NONE"><label for="c-none">Keine Kompensation</label></li>
          <li><input type="radio" id="c-partial" name="comp_basic" value="PARTIAL"><label for="c-partial">Teilweise kompensiert</label></li>
          <li><input type="radio" id="c-full" name="comp_basic" value="FULL"><label for="c-full">Vollst√§ndig kompensiert</label></li>
        </ul>
      </fieldset>
      
      <fieldset id="comp-advanced-fieldset" class="hidden" disabled>
        <legend class="text-lg font-semibold text-gray-800 m-0 mb-4">2. Kompensations-Analyse (Advanced)</legend>
        <ul class="response-list two-col">
          <li><input type="radio" id="ca-none" name="comp_advanced" value="NONE"><label for="ca-none">Keine Kompensation</label></li>
          <li><input type="radio" id="ca-resp-partial" name="comp_advanced" value="RESP_PARTIAL"><label for="ca-resp-partial">Respiratorische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-met-partial" name="comp_advanced" value="MET_PARTIAL"><label for="ca-met-partial">Metabolische Teil-Komp.</label></li>
          <li><input type="radio" id="ca-resp-full" name="comp_advanced" value="RESP_FULL"><label for="ca-resp-full">Respiratorische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-met-full" name="comp_advanced" value="MET_FULL"><label for="ca-met-full">Metabolische Voll-Komp.</label></li>
          <li><input type="radio" id="ca-mixed" name="comp_advanced" value="C_MIXED"><label for="ca-mixed">Gemischte St√∂rung</label></li>
        </ul>
      </fieldset>
    </div>

    <div class="card">
      <details id="explain-wrap" class="mb-4">
        <summary>
          <div class="flex items-center">
            <span id="status-dot" style="display:inline-block;width:12px;height:12px;border-radius:50%;margin-right:8px;background-color:#9ca3af;"></span>
            <span id="result-text">Bitte Werte auswerten</span>
          </div>
        </summary>
        <div class="content text-sm text-gray-700" id="explanation">
          Bitte w√§hle eine prim√§re St√∂rung und die Kompensation aus.
        </div>
      </details>
      
      <div id="clinical-explanation-container" class="hidden">
        <div class="clinical-explanation">
          <h4>üéì Klinische Bedeutung</h4>
          <div id="clinical-explanation-text"></div>
        </div>
      </div>

      <div class="flex flex-wrap gap-3 mt-4">
        <button id="evalbutton" class="btn btn-primary flex-1">Auswerten</button>
        <button id="resetbutton" class="btn btn-secondary">Zur√ºcksetzen</button>
        <button id="nextcasebutton" class="btn btn-secondary">N√§chster Fall</button>
      </div>
      
    </div>

  </div>

  <footer class="max-w-3xl mx-auto text-center text-xs text-gray-500 mt-8 mb-4 px-4">
    <p><strong>Wichtiger Hinweis:</strong> Dieses Tool dient ausschlie√ülich zu √úbungszwecken.</p>
  </footer>

  <script>
    const NORMBEREICHE = {
      ph: { min: 7.35, max: 7.45 },
      pco2: { min: 35, max: 45 },
      hco3: { min: 22, max: 26 },
      be: { min: -2, max: 2 },
      laktat: { min: 0.5, max: 2.0 },
      na: { min: 135, max: 145 },
      cl: { min: 98, max: 108 },
      k: { min: 3.5, max: 5.0 },
      glukose: { min: 70, max: 110 }
    };

    const CASES = [
      {
        id: 1, mode: 'basic', complexity: 'Basis',
        context: '68-j√§hriger Patient mit bekannter COPD, zunehmende Dyspnoe seit 3 Tagen.',
        ph: 7.28, pco2: 62, hco3: 28, be: 2, laktat: 1.2, na: 140, cl: 104, k: 4.1, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'COPD-Exazerbation f√ºhrt zu CO2-Retention durch Bronchospasmus.',
          compensation: 'Nieren resorbieren vermehrt Bikarbonat. Dauert 3-5 Tage.',
          nursing: 'Atemerleichternde Lagerung, Vigilanz-Monitoring, NIV-Optimierung.'
        }
      },
      {
        id: 2, mode: 'basic', complexity: 'Basis',
        context: 'Postoperative Patientin, Opioide zur Schmerztherapie. Atemfrequenz 8/min.',
        ph: 7.25, pco2: 68, hco3: 24, be: -1, laktat: 1.0, na: 138, cl: 103, k: 3.9, glukose: 98,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Opioide d√§mpfen das Atemzentrum, f√ºhren zu Hypoventilation.',
          compensation: 'Keine Kompensation bei akutem Ereignis.',
          nursing: 'SOFORT: Naloxon bereithalten, Atemfrequenz monitoren, O2-Gabe.'
        }
      },
      {
        id: 3, mode: 'basic', complexity: 'Basis',
        context: '52-j√§hriger Patient, BMI 48, chronische Hypoventilation.',
        ph: 7.36, pco2: 58, hco3: 32, be: 6, laktat: 1.1, na: 141, cl: 102, k: 4.2, glukose: 115,
        primary: 'RESP_ACI', comp_basic: 'FULL', comp_advanced: 'MET_FULL',
        explanation: {
          pathophysiology: 'Extreme Adipositas beeintr√§chtigt Atemmechanik.',
          compensation: 'Vollst√§ndige metabolische Kompensation, chronischer Zustand.',
          nursing: 'Schlafapnoe-Screening, NIV-Therapie, Gewichtsreduktion.'
        }
      },
      {
        id: 4, mode: 'basic', complexity: 'Basis',
        context: '32-j√§hrige Patientin, Panikattacke mit Kribbeln, Schwindel.',
        ph: 7.52, pco2: 28, hco3: 23, be: -1, laktat: 0.9, na: 140, cl: 105, k: 4.0, glukose: 98,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Psychogene Hyperventilation bei Angst, CO2-Abatmung.',
          compensation: 'Akut, keine Zeit f√ºr Kompensation.',
          nursing: 'Beruhigende Gespr√§chsf√ºhrung, Atem√ºbungen. NICHT in T√ºte atmen!'
        }
      },
      {
        id: 5, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Appendektomie, starke Schmerzen, schnelle Atmung.',
        ph: 7.48, pco2: 32, hco3: 24, be: 0, laktat: 1.1, na: 139, cl: 104, k: 4.1, glukose: 110,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Schmerz f√ºhrt zu Hyperventilation, CO2-Verlust.',
          compensation: 'Keine Kompensation, frische St√∂rung.',
          nursing: 'Schmerztherapie optimieren! Nach Schmerzlinderung normalisiert sich die Atmung.'
        }
      },
      {
        id: 6, mode: 'basic', complexity: 'Basis',
        context: '24-j√§hriger Diabetiker, Erbrechen, Insulin vergessen. BZ 420 mg/dl.',
        ph: 7.18, pco2: 28, hco3: 10, be: -15, laktat: 2.1, na: 135, cl: 98, k: 5.2, glukose: 420,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Insulinmangel f√ºhrt zu Ketonk√∂rper-Bildung, starke Azidose.',
          compensation: 'Kussmaul-Atmung versucht Kompensation.',
          nursing: 'NOTFALL! Volumengabe, Insulin-Perfusor, Kalium-Substitution, BZ-Kontrollen.'
        }
      },
      {
        id: 7, mode: 'basic', complexity: 'Basis',
        context: '72-j√§hrige nach Herzoperation, Urin unter 100ml/24h, Kreatinin 4.8.',
        ph: 7.28, pco2: 36, hco3: 16, be: -9, laktat: 1.5, na: 138, cl: 108, k: 5.8, glukose: 115,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Akutes Nierenversagen, S√§uren werden nicht ausgeschieden.',
          compensation: 'Keine Kompensation, akuter Prozess.',
          nursing: 'Bilanzierung, Fl√ºssigkeitsrestriktion, EKG-Monitoring wegen Hyperkali√§mie, Dialyse vorbereiten.'
        }
      },
      {
        id: 8, mode: 'basic', complexity: 'Basis',
        context: '45-j√§hriger mit Norovirus, √ºber 15 w√§ssrige Durchf√§lle pro Tag.',
        ph: 7.30, pco2: 35, hco3: 17, be: -8, laktat: 1.2, na: 136, cl: 112, k: 3.2, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bikarbonat-Verlust √ºber Darm, hyperchlor√§mische Azidose.',
          compensation: 'Noch keine Kompensation.',
          nursing: 'Volumengabe mit Elektrolytl√∂sungen, Kalium substituieren, Isolierung bei Norovirus.'
        }
      },
      {
        id: 9, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit kardiogenem Schock, RR 75/50, kaltschwei√üig.',
        ph: 7.22, pco2: 32, hco3: 13, be: -12, laktat: 6.8, na: 138, cl: 104, k: 4.8, glukose: 185,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Schock f√ºhrt zu Gewebehypoxie, anaerober Stoffwechsel, Laktat-Akkumulation.',
          compensation: 'Teilweise respiratorisch, aber insuffizient.',
          nursing: 'KRITISCH! Volumengabe, Katecholamine, Laktat-Kontrollen, h√§modynamisches Monitoring.'
        }
      },
      {
        id: 10, mode: 'advanced', complexity: 'Advanced',
        context: 'Polytrauma, Milzruptur mit Schock, Hypothermie 34 Grad C.',
        ph: 7.08, pco2: 48, hco3: 14, be: -15, laktat: 9.2, na: 145, cl: 115, k: 5.8, glukose: 185,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'C_MIXED',
        explanation: {
          pathophysiology: 'Letale Trias: Azidose plus Hypothermie plus Koagulopathie. Gemischte St√∂rung.',
          compensation: 'Keine Kompensation, zus√§tzliche respiratorische Azidose!',
          nursing: 'SCHWERSTVERLETZTER! Damage Control Surgery, Massivtransfusion, Wiedererw√§rmung, permissive Hypotension.'
        }
      },
      {
        id: 11, mode: 'basic', complexity: 'Basis',
        context: '24-j√§hrige Patientin mit schwerem Asthma-Anfall, stark dyspnoisch trotz Salbutamol.',
        ph: 7.22, pco2: 72, hco3: 25, be: -1, laktat: 1.3, na: 139, cl: 105, k: 3.7, glukose: 110,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Beim schweren Asthma-Anfall f√ºhrt die massive Bronchialobstruktion zur Hypoventilation. Steigt der pCO‚ÇÇ an, ist dies ein Alarmzeichen f√ºr drohende Ersch√∂pfung.',
          compensation: 'Akute St√∂rung ohne Kompensation. Ein pCO‚ÇÇ √ºber 60 mmHg bei Asthma bedeutet drohende Atemersch√∂pfung und kann eine Intubationsindikation darstellen.',
          nursing: 'NOTFALL! Intensivmonitoring, Intubationsbereitschaft, hochdosierte Kortikosteroide und Bronchodilatatoren, Sauerstoff-Hochfluss, beruhigende Gespr√§chsf√ºhrung.'
        }
      },
      {
        id: 12, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit ALS, progrediente Atemschw√§che, n√§chtliche Dyspnoe.',
        ph: 7.33, pco2: 54, hco3: 28, be: 2, laktat: 0.9, na: 140, cl: 103, k: 4.0, glukose: 95,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei ALS kommt es zur Degeneration der motorischen Neuronen mit progredienter Schw√§che der Atemmuskulatur. Die Pumpfunktion der Lunge wird beeintr√§chtigt.',
          compensation: 'Teilweise metabolische Kompensation durch renale Bikarbonat-Retention. Dies deutet auf eine bereits l√§nger bestehende Hypoventilation hin.',
          nursing: 'Regelm√§√üige Vitalkapazit√§tsmessungen, Beratung zu NIV-Therapie, Sekretmanagement, Hustenassistenz-Techniken. Fr√ºhzeitige Einbindung palliativmedizinischer Versorgung.'
        }
      },
      {
        id: 13, mode: 'basic', complexity: 'Basis',
        context: 'Verkehrsunfall mit Rippenserienfraktur rechts, starke atemabh√§ngige Schmerzen.',
        ph: 7.30, pco2: 56, hco3: 26, be: 0, laktat: 1.8, na: 138, cl: 104, k: 4.3, glukose: 130,
        primary: 'RESP_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Rippenfrakturen f√ºhren zu starken atemabh√§ngigen Schmerzen und damit zur Schonatmung. Zus√§tzlich kann eine Lungenkontusion die Gasaustauschfl√§che reduzieren.',
          compensation: 'Akute St√∂rung ohne Kompensation. Das leicht erh√∂hte Laktat kann auf eine beginnende Gewebehypoxie oder Stressreaktion hinweisen.',
          nursing: 'Ad√§quate Schmerztherapie (Epiduralkatheter erw√§gen), Atemtherapie mit Anleitung zu effektiver Hustentechnik, Mobilisation unter Schmerzschutz, Pneumonie-Prophylaxe.'
        }
      },
      {
        id: 14, mode: 'basic', complexity: 'Basis',
        context: 'Beatmeter Patient auf Intensivstation, Alarm hoher pCO‚ÇÇ. Tidalvolumen zu niedrig.',
        ph: 7.27, pco2: 65, hco3: 27, be: 1, laktat: 1.1, na: 141, cl: 105, k: 4.0, glukose: 105,
        primary: 'RESP_ACI', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Bei unzureichenden Beatmungsparametern wird nicht genug CO‚ÇÇ abgeatmet. Dies f√ºhrt zur iatrogenen respiratorischen Azidose.',
          compensation: 'Beginnende metabolische Kompensation. Bei beatmeten Patienten sollte jedoch prim√§r die Beatmung optimiert werden.',
          nursing: 'Beatmungsparameter mit Arzt besprechen und anpassen. Ursachen f√ºr erh√∂hten Atemwegswiderstand ausschlie√üen: Tubuslage, Sekret, Bronchospasmus pr√ºfen.'
        }
      },
      {
        id: 15, mode: 'basic', complexity: 'Basis',
        context: 'Beatmeter Patient nach Sch√§del-Hirn-Trauma, Atemfrequenz erh√∂ht wegen ICP.',
        ph: 7.50, pco2: 30, hco3: 23, be: -1, laktat: 1.0, na: 140, cl: 103, k: 4.0, glukose: 105,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei erh√∂htem intrakraniellem Druck wird manchmal therapeutisch eine leichte Hyperventilation eingesetzt. Der niedrige pCO‚ÇÇ f√ºhrt zu zerebraler Vasokonstriktion.',
          compensation: 'Keine Kompensation bei akuter, therapeutisch gewollter Hyperventilation.',
          nursing: 'Bei SHT-Patienten ist dies teils gewollt, aber engmaschiges ICP-Monitoring erforderlich. Ziel-pCO‚ÇÇ meist 32 bis 35 mmHg, niemals unter 30 mmHg. Zu starke Hyperventilation kann Hirndurchblutung gef√§hrden.'
        }
      },
      {
        id: 16, mode: 'basic', complexity: 'Basis',
        context: 'Bergsteiger in 3500 Meter H√∂he, Kopfschmerzen, √úbelkeit, Schwindel, schnelle Atmung.',
        ph: 7.46, pco2: 33, hco3: 23, be: -1, laktat: 1.2, na: 138, cl: 104, k: 4.1, glukose: 95,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'In gro√üer H√∂he ist der Sauerstoffpartialdruck niedriger. Der K√∂rper reagiert mit kompensatorischer Hyperventilation, dabei wird auch mehr CO‚ÇÇ abgeatmet.',
          compensation: 'Noch keine Kompensation, da die H√∂henexposition erst seit kurzem besteht. Bei l√§ngerer Akklimatisation w√ºrden die Nieren durch Bikarbonat-Ausscheidung kompensieren.',
          nursing: 'Bei H√∂henkrankheit ist Abstieg die beste Therapie. Symptomatische Behandlung mit Analgetika gegen Kopfschmerzen. Bei Verschlechterung: sofortiger Abstieg lebensnotwendig. Prophylaxe durch langsame Akklimatisation.'
        }
      },
      {
        id: 17, mode: 'basic', complexity: 'Basis',
        context: 'Patientin mit Harnwegsinfekt, seit heute Fieber 39 Grad, Tachypnoe 28 pro Minute, verwirrt.',
        ph: 7.48, pco2: 31, hco3: 23, be: -1, laktat: 2.4, na: 137, cl: 105, k: 4.3, glukose: 145,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei beginnender Sepsis f√ºhren Entz√ºndungsmediatoren zu einer Stimulation des Atemzentrums. Dies ist eines der fr√ºhen Zeichen einer Sepsis. Das erh√∂hte Laktat ist wichtiger Hinweis auf systemische Entz√ºndung.',
          compensation: 'Akute St√∂rung ohne Kompensation. Wichtig: Das erh√∂hte Laktat deutet darauf hin, dass sich m√∂glicherweise bald auch eine metabolische Azidose entwickeln wird.',
          nursing: 'SEPSIS-Verdacht gleich NOTFALL! Blutkulturen abnehmen, dann sofort Breitspektrum-Antibiotika innerhalb einer Stunde, Fl√ºssigkeitstherapie nach Protokoll. Engmaschiges Monitoring, qSOFA-Score dokumentieren.'
        }
      },
      {
        id: 18, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Verkehrsunfall, pl√∂tzliche Dyspnoe und Thoraxschmerz, frisch operiert vor f√ºnf Tagen.',
        ph: 7.50, pco2: 29, hco3: 22, be: -2, laktat: 1.8, na: 139, cl: 106, k: 4.0, glukose: 115,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei Lungenembolie f√ºhren die pl√∂tzliche Dyspnoe und Hypoxie zu reflektorischer Hyperventilation. Zus√§tzlich werden Irritationsrezeptoren in der Lunge stimuliert. Das leicht erh√∂hte Laktat kann auf rechtsventrikul√§re Belastung hinweisen.',
          compensation: 'Keine Kompensation bei akutem Ereignis. Die respiratorische Alkalose ist hier ein wichtiger diagnostischer Hinweis bei Verdacht auf Lungenembolie.',
          nursing: 'Lungenembolie gleich NOTFALL! Sofortige √§rztliche Untersuchung, D-Dimer-Bestimmung, CT-Angiographie. Sauerstoff-Gabe, Oberk√∂rperhochlagerung, Antikoagulation nach Anordnung. Thrombose-Prophylaxe-Standards √ºberpr√ºfen.'
        }
      },
      {
        id: 19, mode: 'basic', complexity: 'Basis',
        context: 'Dialyse-Patient, letzte Dialyse vor vier Tagen, heute terminliche Dialyse ausgefallen.',
        ph: 7.32, pco2: 32, hco3: 16, be: -9, laktat: 1.3, na: 140, cl: 106, k: 5.5, glukose: 108,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei chronischer Niereninsuffizienz akkumulieren Stoffwechsels√§uren kontinuierlich. Die Dialyse entfernt diese S√§uren regelm√§√üig. Wenn die Dialyse ausf√§llt, verschlechtert sich die Azidose. Die Hyperkali√§mie ist typisch und potenziell lebensbedrohlich.',
          compensation: 'Teilweise respiratorische Kompensation durch Hyperventilation. Bei chronischen Dialysepatienten ist eine leichte metabolische Azidose oft chronisch vorhanden.',
          nursing: 'DRINGEND Dialyse organisieren! EKG-Kontrolle wegen Hyperkali√§mie. Fl√ºssigkeits- und Kalium-Restriktion bis zur Dialyse. Bei Kalium √ºber sechs oder EKG-Ver√§nderungen: Notfall-Ma√ünahmen wie Calcium intraven√∂s, Insulin plus Glukose.'
        }
      },
      {
        id: 20, mode: 'basic', complexity: 'Basis',
        context: 'Diabetikerin unter Metformin, seit zwei Tagen Durchfall und Erbrechen, zunehmend verwirrt.',
        ph: 7.20, pco2: 30, hco3: 11, be: -14, laktat: 8.2, na: 137, cl: 105, k: 4.9, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Metformin hemmt die Glukoneogenese in der Leber. Bei eingeschr√§nkter Nierenfunktion durch Exsikkose f√ºhrt dies zur Laktat-Akkumulation. Laktat kann nicht mehr zu Glukose umgewandelt werden. Das extrem hohe Laktat und der niedrige Blutzucker sind typisch.',
          compensation: 'Teilweise respiratorische Kompensation, aber bei so schwerem Laktat-Anstieg insuffizient. Die Verwirrtheit ist Zeichen der schweren Azidose und Gewebehypoxie.',
          nursing: 'NOTFALL - Intensivstation! Metformin SOFORT absetzen. Volumengabe, Bikarbonat-Pufferung bei pH unter 7.1, bei refrakt√§ren F√§llen: Dialyse zur Laktat- und Metformin-Elimination. Glukose-Infusion wegen Hypoglyk√§mie-Gefahr.'
        }
      },
      {
        id: 21, mode: 'basic', complexity: 'Basis',
        context: 'Junger Mann nach exzessivem Crossfit-Training, extreme Muskelschmerzen, Cola-farbener Urin.',
        ph: 7.26, pco2: 33, hco3: 14, be: -11, laktat: 3.2, na: 139, cl: 106, k: 5.6, glukose: 110,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Rhabdomyolyse werden durch Muskelzellzerfall massiv intrazellul√§re Substanzen freigesetzt: Myoglobin, Kalium, Phosphat, Purine. Die Hyperurik√§mie und Phosphat-Freisetzung f√ºhren zur metabolischen Azidose. Myoglobin ist nephrotoxisch und kann zu akutem Nierenversagen f√ºhren.',
          compensation: 'Teilweise respiratorische Kompensation durch Hyperventilation. Die Kreatinkinase w√§re hier extrem erh√∂ht √ºber zehntausend U pro Liter, diagnostisch wichtig.',
          nursing: 'Aggressive Volumengabe von sechs bis zw√∂lf Liter pro Tag zur Ausschwemmung von Myoglobin und Nierenschutz. Urin-Alkalisierung mit Natriumbikarbonat erw√§gen, pH √ºber 6.5 anstreben. St√ºndliche Urinkontrollen. Hyperkali√§mie-Monitoring am EKG. Bei Oligurie trotz Volumengabe: Nierenersatzverfahren.'
        }
      },
      {
        id: 22, mode: 'basic', complexity: 'Basis',
        context: 'Patient nach Ingestion von Frostschutzmittel vor sechs Stunden, zunehmend somnolent, Sehst√∂rungen.',
        ph: 7.15, pco2: 26, hco3: 9, be: -16, laktat: 4.5, na: 138, cl: 98, k: 4.2, glukose: 105,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Ethylenglykol wird in der Leber zu toxischen Metaboliten abgebaut: Glykols√§ure, Oxals√§ure. Diese verursachen eine schwere metabolische Azidose mit erh√∂hter Anionenl√ºcke. Die Oxalat-Kristalle sch√§digen die Nieren. Die Sehst√∂rungen entstehen durch Sch√§digung des Nervus opticus.',
          compensation: 'Teilweise respiratorische Kompensation, aber insuffizient bei so schwerer Vergiftung. Die osmotische L√ºcke ist hier erh√∂ht, wichtiges diagnostisches Kriterium neben der Anionenl√ºcke.',
          nursing: 'VERGIFTUNGS-NOTFALL! Giftnotruf einschalten. Antidot: Fomepizol hemmt Alkoholdehydrogenase, verhindert toxische Metaboliten, oder alternativ Ethanol-Infusion. H√§modialyse bei schwerer Vergiftung. Volumengabe, Bikarbonat-Pufferung. Thiamin und Pyridoxin geben. Regelm√§√üige Osmolalit√§t-Kontrollen.'
        }
      },
      {
        id: 23, mode: 'basic', complexity: 'Basis',
        context: 'Patient drei Wochen nach Darm-OP mit Ileostoma, Ausscheidung √ºber zwei Liter pro Tag, schwach und schwindelig.',
        ph: 7.31, pco2: 36, hco3: 18, be: -7, laktat: 1.1, na: 134, cl: 110, k: 3.1, glukose: 92,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Bei Ileostoma mit hohem Output gehen gro√üe Mengen bikarbonatreicher Fl√ºssigkeit verloren. Der Dickdarm, der normalerweise Wasser und Bikarbonat r√ºckresorbiert, fehlt. Dies f√ºhrt zur hyperchlor√§mischen metabolischen Azidose. Die Hypokali√§mie und Hyponatri√§mie entstehen durch die Elektrolytverluste.',
          compensation: 'Keine respiratorische Kompensation erkennbar. Die St√∂rung entwickelt sich subakut √ºber Tage bis Wochen.',
          nursing: 'Stomaberatung einschalten! Motilit√§tshemmer erw√§gen wie Loperamid. Volumengabe mit balancierten Elektrolytl√∂sungen. Orale Rehydratationsl√∂sung, spezielle Stoma-L√∂sungen. Kalium und Magnesium substituieren. Patienten-Schulung: ausreichend Trinken von zwei bis drei Liter pro Tag, Meiden von stark abf√ºhrenden Nahrungsmitteln.'
        }
      },
      {
        id: 24, mode: 'basic', complexity: 'Basis',
        context: 'Patient mit Pneumonie-Sepsis, Fieber 39.5 Grad, Tachykardie, Hypotonie trotz Volumengabe.',
        ph: 7.25, pco2: 30, hco3: 13, be: -12, laktat: 5.2, na: 136, cl: 105, k: 4.6, glukose: 175,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Sepsis f√ºhren Entz√ºndungsmediatoren zu Mikrozirkulationsst√∂rungen und Gewebehypoxie. Trotz ausreichender Sauerstoff-S√§ttigung k√∂nnen die Zellen den Sauerstoff nicht verwerten, sogenannte zytopathische Hypoxie. Dies f√ºhrt zu anaerober Glykolyse und Laktat-Akkumulation. Das Laktat ist hier Marker f√ºr Organdysfunktion und Mortalit√§t. Laktat √ºber vier mmol pro Liter definiert den septischen Schock.',
          compensation: 'Teilweise respiratorische Kompensation durch septische Hyperventilation. Der niedrige pCO‚ÇÇ zeigt die Atemantwort auf die Azidose und ist gleichzeitig Zeichen der Sepsis selbst.',
          nursing: 'SEPSIS gleich NOTFALL! Sepsis-Bundle innerhalb einer Stunde: Blutkulturen, Antibiotika, Volumengabe drei√üig ml pro kg, Laktat-Kontrolle. Katecholamine bei persistierender Hypotonie, Noradrenalin ist first-line. Focus-Sanierung hier: Pneumonie-Therapie. Engmaschiges Monitoring, Organfunktionen √ºberwachen. Laktat-Clearance ist wichtiger Verlaufsparameter.'
        }
      },
      {
        id: 25, mode: 'advanced', complexity: 'Advanced',
        context: 'Patient mit ausgedehnter Darmresektion, chronische Diarrhoe, neurologische Symptome wie Ataxie, undeutliche Sprache.',
        ph: 7.28, pco2: 31, hco3: 14, be: -11, laktat: 1.8, na: 137, cl: 106, k: 3.8, glukose: 95,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei Kurzdarmsyndrom entsteht durch bakterielle Fehlbesiedlung D-Laktat im Gegensatz zum normalen L-Laktat. Standard-Laktat-Tests messen nur L-Laktat, daher ist das gemessene Laktat hier normal niedrig trotz schwerer Azidose. D-Laktat ist neurotoxisch und verursacht die charakteristischen neurologischen Symptome. Die erh√∂hte Anionenl√ºcke trotz normalem Laktat ist der diagnostische Hinweis.',
          compensation: 'Teilweise respiratorische Kompensation. Diese seltene Form der Azidose wird oft fehldiagnostiziert, weil das Standard-Laktat nicht erh√∂ht ist. Man muss gezielt D-Laktat bestimmen.',
          nursing: 'Spezialfall! D-Laktat muss speziell angefordert werden, nicht im Standard-Labor. Therapie: Antibiotika gegen bakterielle Fehlbesiedlung, Probiotika, Ern√§hrungsumstellung kohlenhydratarm. Neurologische Symptome bilden sich nach Behandlung meist zur√ºck. Patienten mit Kurzdarmsyndrom ben√∂tigen spezialisierte Ern√§hrungsberatung. Cave: diese Patienten sind oft unterern√§hrt und ben√∂tigen gegebenenfalls parenterale Ern√§hrung.'
        }
      },
      {
        id: 26, mode: 'advanced', complexity: 'Advanced',
        context: 'Diabetiker mit Herzinsuffizienz, nimmt Metformin, jetzt kardiogene Dekompensation mit √ñdemen.',
        ph: 7.19, pco2: 28, hco3: 10, be: -15, laktat: 9.5, na: 132, cl: 98, k: 5.4, glukose: 78,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Bei kardialer Dekompensation kommt es zur Gewebehypoperfusion. In Kombination mit Metformin, das die mitochondriale Atmung hemmt, entsteht die Metformin-assoziierte Laktatazidose MALA. Die eingeschr√§nkte Nierenfunktion bei Herzinsuffizienz f√ºhrt zu Metformin-Akkumulation. Das extrem hohe Laktat von 9.5 und die Hypoglyk√§mie trotz Diabetes sind charakteristisch. Die Hyponatri√§mie ist typisch f√ºr dekompensierte Herzinsuffizienz.',
          compensation: 'Respiratorische Teilkompensation, aber bei so extremer Azidose insuffizient. MALA hat eine hohe Mortalit√§t von drei√üig bis f√ºnfzig Prozent.',
          nursing: 'H√ñCHSTE NOTFALLSTUFE! Intensivstation, Metformin sofort stoppen. Herzinsuffizienz-Therapie optimieren mit Diuretika, Katecholamine bei Bedarf. Bikarbonat-Pufferung bei pH unter 7.1. H√§modialyse erw√§gen, entfernt Metformin und Laktat. Glukose-Infusion wegen Hypoglyk√§mie-Risiko. Cave: Metformin ist bei schwerer Herzinsuffizienz NYHA drei bis vier kontraindiziert, h√§tte nie gegeben werden d√ºrfen.'
        }
      },
      {
        id: 27, mode: 'advanced', complexity: 'Advanced',
        context: 'Beatmeter Patient, seit f√ºnf Tagen Propofol-Dauersedierung, jetzt Bradykardie, gr√ºnlicher Urin, Herzrhythmusst√∂rungen.',
        ph: 7.20, pco2: 35, hco3: 13, be: -12, laktat: 7.8, na: 138, cl: 105, k: 5.9, glukose: 45,
        primary: 'MET_ACI', comp_basic: 'NONE', comp_advanced: 'NONE',
        explanation: {
          pathophysiology: 'Das Propofol-Infusions-Syndrom ist eine seltene, aber lebensbedrohliche Komplikation bei Langzeit-Propofol-Gabe √ºber achtundvierzig Stunden, √ºber vier mg pro kg pro Stunde. Es kommt zu mitochondrialer Dysfunktion mit Laktatazidose, Rhabdomyolyse daher der gr√ºne Urin durch Myoglobin, Herzversagen und Hyperkali√§mie. Die Hypoglyk√§mie entsteht durch gest√∂rte Glukoneogenese. Triglyzeride sind massiv erh√∂ht √ºber tausend mg pro dl.',
          compensation: 'Keine Kompensation bei akutem Organversagen. Die Bradykardie und Arrhythmien sind Zeichen der kardialen Beteiligung. PRIS hat eine Mortalit√§t von drei√üig bis achtzig Prozent.',
          nursing: 'LEBENSBEDROHLICHER NOTFALL! Propofol SOFORT stoppen, auf alternatives Sedativum umstellen wie Midazolam. Intensivtherapie: Volumengabe, Pufferung, bei Herzversagen: Katecholamine, gegebenenfalls ECMO erw√§gen. Dialyse bei refrakt√§rer Azidose. Triglyzeride, CK, Myoglobin kontrollieren. Cave: bei Kindern und auf Intensivstation besonders aufmerksam sein, PRIS vermeiden durch Dosislimitierung und zeitliche Begrenzung von Propofol.'
        }
      },
      {
        id: 28, mode: 'advanced', complexity: 'Advanced',
        context: 'Leuk√§mie-Patient, zweiter Tag nach Chemotherapie-Beginn, Oligurie, Herzrhythmusst√∂rungen.',
        ph: 7.24, pco2: 30, hco3: 12, be: -13, laktat: 2.1, na: 136, cl: 104, k: 6.8, glukose: 105,
        primary: 'MET_ACI', comp_basic: 'PARTIAL', comp_advanced: 'RESP_PARTIAL',
        explanation: {
          pathophysiology: 'Beim Tumor-Lyse-Syndrom werden durch den massiven Zerfall von Tumorzellen gro√üe Mengen intrazellul√§rer Substanzen freigesetzt: Kalium, Phosphat, Purine. Die Purine werden zu Harns√§ure abgebaut, die ausf√§llt und die Nieren sch√§digt, akutes Nierenversagen. Die Hyperphosphat√§mie bindet Calcium, Hypokalz√§mie mit Tetanie-Risiko. Die metabolische Azidose entsteht durch Nierenversagen und Phosphat-Akkumulation. Die Hyperkali√§mie ist extrem gef√§hrlich, Herzstillstand-Risiko.',
          compensation: 'Teilweise respiratorische Kompensation, aber bei so schwerer St√∂rung insuffizient. Dies ist ein onkologischer Notfall.',
          nursing: 'ONKOLOGISCHER NOTFALL! Intensivmonitoring mit Tele-EKG wegen Hyperkali√§mie. Aggressive Hyperhydratation drei Liter pro m¬≤ pro Tag, Urin-Alkalisierung. Rasburicase spaltet Harns√§ure. Bei Hyperkali√§mie √ºber 6.5: Notfall-Management mit Calcium intraven√∂s, Insulin plus Glukose. Dialyse bei refrakt√§rem Nierenversagen. Phosphatbinder, Calcium-Substitution bei Hypokalz√§mie. Engmaschige Laborkontrollen alle vier bis sechs Stunden.'
        }
      },
      {
        id: 29, mode: 'advanced', complexity: 'Advanced',
        context: 'Patientin mit unbehandelter Hyperthyreose, jetzt Fieber vierzig Grad, Tachykardie hundertsechzig pro Minute, massiv geschwitzt.',
        ph: 7.51, pco2: 27, hco3: 21, be: -3, laktat: 3.2, na: 148, cl: 110, k: 3.0, glukose: 165,
        primary: 'RESP_ALK', comp_basic: 'NONE', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'Die thyreotoxische Krise ist ein lebensbedrohlicher Notfall. Der massive √úberschuss an Schilddr√ºsenhormonen f√ºhrt zu extremer Stoffwechselsteigerung mit Hyperventilation. Die Hypernatri√§mie von einhundertachtundvierzig und Hypokali√§mie von drei entstehen durch Schwitzen und gesteigerte Diurese. Das erh√∂hte Laktat zeigt die metabolische Entgleisung.',
          compensation: 'Beginnende metabolische Kompensation durch renale Bikarbonat-Ausscheidung, HCO‚ÇÉ‚Åª und BE leicht erniedrigt. Aber: Die Situation ist zu akut f√ºr vollst√§ndige Kompensation. Das Laktat deutet zus√§tzlich auf eine beginnende metabolische Azidose hin.',
          nursing: 'NOTFALL - Intensivstation! Thyreostatika hochdosiert, Betablocker Cave: keine Kontraindikationen, Cortison, Fl√ºssigkeit und Elektrolyte. K√ºhlung keine Eisb√§der. Monitoring von Temperatur, Herzfrequenz, Blutdruck. Die Hypokali√§mie muss dringend korrigiert werden, Arrhythmie-Gefahr bei Tachykardie. Mortalit√§t ohne Behandlung bis drei√üig Prozent.'
        }
      },
      {
        id: 30, mode: 'advanced', complexity: 'Advanced',
        context: 'Schwangere in sechsunddrei√üigster SSW, leichte Luftnot beim Treppensteigen, ansonsten beschwerdefrei.',
        ph: 7.44, pco2: 32, hco3: 21, be: -3, laktat: 1.0, na: 136, cl: 104, k: 3.8, glukose: 88,
        primary: 'RESP_ALK', comp_basic: 'PARTIAL', comp_advanced: 'MET_PARTIAL',
        explanation: {
          pathophysiology: 'In der Schwangerschaft f√ºhrt das Hormon Progesteron zu einer gesteigerten Atemantwort. Zus√§tzlich dr√ºckt der wachsende Uterus das Zwerchfell nach oben, was die funktionelle Residualkapazit√§t reduziert. Der K√∂rper kompensiert mit erh√∂hter Atemfrequenz. Dies ist eine physiologische Anpassung an die Schwangerschaft.',
          compensation: 'Teilweise metabolische Kompensation durch die Nieren. Dies zeigt, dass die Hyperventilation schon l√§nger besteht. Diese BGA-Ver√§nderungen sind f√ºr das dritte Trimenon normal und stellen keine Krankheit dar.',
          nursing: 'Schwangere √ºber die physiologischen Ver√§nderungen aufkl√§ren, dies ist normal. Atem√ºbungen k√∂nnen helfen, mit der Dyspnoe besser umzugehen. Eisenstatus pr√ºfen, An√§mie kann Dyspnoe verst√§rken. Bei starker Verschlechterung oder zus√§tzlichen Symptomen wie Brustschmerz, starke √ñdeme: an Pr√§eklampsie oder Lungenembolie denken.'
        }
      }
    ];

    let currentIndex = 0;
    let currentMode = 'basic';

    const inputs = {
      ph: document.getElementById('ph'),
      pco2: document.getElementById('pco2'),
      hco3: document.getElementById('hco3'),
      be: document.getElementById('be'),
      laktat: document.getElementById('laktat'),
      na: document.getElementById('na'),
      cl: document.getElementById('cl'),
      k: document.getElementById('k'),
      glukose: document.getElementById('glukose')
    };

    const advancedContainer = document.getElementById('advanced-values-container');
    const primaryFieldset = document.getElementById('primary-fieldset');
    const compBasicFieldset = document.getElementById('comp-basic-fieldset');
    const compAdvancedFieldset = document.getElementById('comp-advanced-fieldset');
    const pMixedLi = document.getElementById('p-mixed-li');
    const modeChip = document.getElementById('mode-chip');
    const explainWrap = document.getElementById('explain-wrap');
    const clinicalExplanationContainer = document.getElementById('clinical-explanation-container');
    const clinicalExplanationText = document.getElementById('clinical-explanation-text');

    function setAmpelColor(key, value) {
      const item = document.getElementById('item-' + key);
      if (!item) return;
      item.classList.remove('norm-green', 'norm-red', 'norm-blue');
      const norm = NORMBEREICHE[key];
      if (!norm) return;
      if (value >= norm.min && value <= norm.max) {
        item.classList.add('norm-green');
      } else if (key === 'ph' || key === 'pco2' || key === 'be' || key === 'laktat') {
        item.classList.add('norm-red');
      } else {
        item.classList.add('norm-blue');
      }
    }

    function getRandomCase() {
      let available = CASES;
      if (currentMode === 'basic') {
        available = CASES.filter(c => c.mode === 'basic');
      } else if (currentMode === 'advanced') {
        available = CASES.filter(c => c.mode === 'advanced');
      }
      const filtered = available.filter((c, idx) => CASES.indexOf(c) !== currentIndex);
      if (filtered.length === 0) return Math.floor(Math.random() * available.length);
      const randomCase = filtered[Math.floor(Math.random() * filtered.length)];
      return CASES.indexOf(randomCase);
    }

    function renderCase(index) {
      if (index === -1) index = getRandomCase();
      const c = CASES[index];
      if (!c) return;
      currentIndex = index;
      
      for (const key in inputs) {
        if (inputs[key] && c[key] != null) {
          inputs[key].value = c[key].toFixed(key === 'ph' ? 2 : 1);
          setAmpelColor(key, c[key]);
        }
      }

      document.getElementById('case-id').textContent = c.id;
      document.getElementById('case-complexity').textContent = c.complexity;
      document.getElementById('case-complexity').className = 'text-xs px-2 py-1 rounded-full ' + 
        (c.complexity === 'Basis' ? 'bg-green-100 text-green-800' : 'bg-orange-100 text-orange-800');
      document.getElementById('clinical-context').textContent = c.context;

      primaryFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compBasicFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compAdvancedFieldset.querySelectorAll('input').forEach(r => r.checked = false);
      compBasicFieldset.disabled = true;
      compAdvancedFieldset.disabled = true;

      explainWrap.open = false;
      document.getElementById('status-dot').style.backgroundColor = '#9ca3af';
      document.getElementById('result-text').textContent = 'Bitte Werte auswerten';
      document.getElementById('explanation').textContent = 'Bitte w√§hle prim√§re St√∂rung und Kompensation.';
      clinicalExplanationContainer.classList.add('hidden');
    }

    function handleModeChange() {
      const newMode = document.querySelector('input[name="mode"]:checked').value;
      currentMode = newMode;
      
      if (currentMode === 'basic') {
        modeChip.textContent = 'BASIS MODUS';
        advancedContainer.classList.add('hidden');
        compBasicFieldset.style.display = 'block';
        compAdvancedFieldset.style.display = 'none';
        pMixedLi.classList.add('hidden');
      } else if (currentMode === 'advanced') {
        modeChip.textContent = 'ADVANCED MODUS';
        advancedContainer.classList.remove('hidden');
        compBasicFieldset.style.display = 'none';
        compAdvancedFieldset.style.display = 'block';
        pMixedLi.classList.remove('hidden');
      } else {
        modeChip.textContent = 'MIXED MODUS';
        advancedContainer.classList.remove('hidden');
        compBasicFieldset.style.display = 'none';
        compAdvancedFieldset.style.display = 'block';
        pMixedLi.classList.remove('hidden');
      }
    }

    function handlePrimarySelection() {
      const primary = document.querySelector('input[name="primary"]:checked');
      if (!primary) {
        compBasicFieldset.disabled = true;
        compAdvancedFieldset.disabled = true;
        return;
      }
      if (primary.value === 'NORMAL') {
        compBasicFieldset.disabled = true;
        compAdvancedFieldset.disabled = true;
        document.getElementById('c-none').checked = true;
        document.getElementById('ca-none').checked = true;
      } else {
        if (currentMode === 'basic') {
          compBasicFieldset.disabled = false;
        } else {
          compAdvancedFieldset.disabled = false;
        }
      }
    }

    function getLabel(key) {
      const labels = {
        NORMAL: 'Normal', RESP_ACI: 'Respiratorische Azidose', RESP_ALK: 'Respiratorische Alkalose',
        MET_ACI: 'Metabolische Azidose', MET_ALK: 'Metabolische Alkalose', P_MIXED: 'Gemischte St√∂rung',
        NONE: 'Keine Kompensation', PARTIAL: 'Teilweise Kompensation', FULL: 'Vollst√§ndige Kompensation',
        RESP_PARTIAL: 'Respiratorische Teil-Kompensation', MET_PARTIAL: 'Metabolische Teil-Kompensation',
        RESP_FULL: 'Respiratorische Voll-Kompensation', MET_FULL: 'Metabolische Voll-Kompensation',
        C_MIXED: 'Gemischte St√∂rung'
      };
      return labels[key] || key;
    }

    document.querySelectorAll('input[name="mode"]').forEach(radio => {
      radio.addEventListener('change', () => {
        handleModeChange();
        renderCase(-1);
      });
    });

    primaryFieldset.addEventListener('change', handlePrimarySelection);

    document.getElementById('evalbutton').addEventListener('click', () => {
      const c = CASES[currentIndex];
      const primaryEl = document.querySelector('input[name="primary"]:checked');
      const compKey = currentMode === 'basic' ? 'comp_basic' : 'comp_advanced';
      const compEl = document.querySelector('input[name="' + compKey + '"]:checked');
      
      if (!primaryEl || !compEl) {
        alert('Bitte w√§hle beide Optionen aus!');
        return;
      }

      const isCorrect = (primaryEl.value === c.primary && compEl.value === c[compKey]);
      document.getElementById('status-dot').style.backgroundColor = isCorrect ? '#16a34a' : '#ef4444';
      document.getElementById('result-text').textContent = isCorrect ? 'Korrekt ‚úì' : 'Nicht korrekt ‚úó';
      document.getElementById('explanation').innerHTML = 
        '<p><strong>Richtige Antwort:</strong> ' + getLabel(c.primary) + ', ' + getLabel(c[compKey]) + '</p>';
      explainWrap.open = true;

      if (c.explanation) {
        clinicalExplanationText.innerHTML = 
          '<p class="mb-2"><strong>Pathophysiologie:</strong><br>' + c.explanation.pathophysiology + '</p>' +
          '<p class="mb-2"><strong>Kompensation:</strong><br>' + c.explanation.compensation + '</p>' +
          '<p><strong>Pflegerisch:</strong><br>' + c.explanation.nursing + '</p>';
        clinicalExplanationContainer.classList.remove('hidden');
      }
    });

    document.getElementById('nextcasebutton').addEventListener('click', () => {
      renderCase(-1);
    });

    document.getElementById('resetbutton').addEventListener('click', () => {
      renderCase(currentIndex);
    });

    window.onload = () => {
      handleModeChange();
      renderCase(-1);
    };
  </script>

</body>
</html>